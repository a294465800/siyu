"use strict";$(document).ready(function(){new Vue({el:"#buildDealAdd",data:{buildDealAdd:_schemas.buildDealAdd,build_teams:[],projects:[],throttle:{id_timer:null,name_timer:null,team_timer:null}},mounted:function(){$("#buildDealAdd").removeClass("invisible")},methods:{querySearchBuild:function(t,e){var a=this;this.throttle.team_timer&&clearTimeout(this.throttle.team_timer),this.throttle.team_timer=setTimeout(function(){var i={id:t};_http.TeamManager.searchTeam(i).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectBuild:function(t){this.buildDealAdd.team=t.id,this.buildDealAdd.build_name=t.name,this.buildDealAdd.build_manager=t.manager},querySearchProjectId:function(t,e){var a=this;this.throttle.id_timer&&clearTimeout(this.throttle.id_timer),this.throttle.id_timer=setTimeout(function(){var i={id:t};_http.ProjectManager.searchProject(i).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectProjectId:function(t){this.buildDealAdd.project_id=t.id,this.buildDealAdd.project_number=t.number,this.buildDealAdd.project_content=t.name,this.buildDealAdd.project_manager=t.pm},querySearchProjectContent:function(t,e){var a=this;this.throttle.name_timer&&clearTimeout(this.throttle.name_timer),this.throttle.name_timer=setTimeout(function(){var i={name:t};_http.ProjectManager.searchProject(i).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectProjectContent:function(t){this.buildDealAdd.project_id=t.id,this.buildDealAdd.project_number=t.number,this.buildDealAdd.project_content=t.name,this.buildDealAdd.project_manager=t.pm},uploadContract:function(t){var e=this,a=t.target.files;if(!(a.length<1)){var i=!0,r=!1,d=void 0;try{for(var n,l=a[Symbol.iterator]();!(i=(n=l.next()).done);i=!0){var o=n.value,s=new FormData;s.append("image",o),_http.UploadManager.createUpload(s).then(function(t){if("200"===t.data.code){var a=t.data.data;e.buildDealAdd.list.push({id:a.size,name:a.name,url:a.url}),e.buildDealAdd.lists.push(a.url),e.$notify({title:"成功",message:a.name+" 上传成功",type:"success"})}else e.$notify({title:"错误",message:t.data.msg,type:"error"})}).catch(function(t){console.log(t),e.$notify({title:"错误",message:"服务器出错",type:"error"})})}}catch(t){r=!0,d=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw d}}}},deleteItem:function(t,e,a){"list"===t?(this.buildDealAdd[list].splice(a,1),this.buildDealAdd[lists].splice(a,1)):this.buildDealAdd[t].splice(a,1)},submit:function(){var t=this;console.log(this.buildDealAdd),_http.TeamManager.createContract(this.buildDealAdd).then(function(e){"200"===e.data.code?t.$notify({title:"成功",message:"提交成功",type:"success"}):t.$notify({title:"错误",message:e.data.msg,type:"error"})}).catch(function(e){t.$notify({title:"错误",message:"服务器出错",type:"error"})})}}})});