"use strict";$(document).ready(function(){var t=JSON.parse($("#contractContent").text()),e=JSON.parse($("#contractTax").text());function n(t){var e={},n=!0,a=!1,r=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var u=o.value;e[u.id]=u.name}}catch(t){a=!0,r=t}finally{try{!n&&i.return&&i.return()}finally{if(a)throw r}}return e}var a=n(e),r=n(t);new Vue({el:"#projectCreate",data:{project:_schemas.projects,contractContent:t,contractTax:e,TaxIDMap:a,ContentIDMap:r},mounted:function(){$("#projectCreate").removeClass("invisible")},computed:{sumAmount:function(){var t=this.project.masterContract,e=this.project.subContract,n=0,a=[];function r(t,e){if(e.length<1)return!1;e.forEach(function(e,r){var o=e.amount?parseFloat(e.amount):0;n+=o,a.push({head:0===r,id:t+e.id,amount:o.toLocaleString("en-US"),type:t})})}return r("m",t),r("s",e),{sum:n.toLocaleString("en-US"),result:a}},sumContent:function(){var t=this,e=t.project.masterContract,n=t.project.subContract,a=0,r={},o=[];if(e&&n){u(e),u(n);for(var i in r)o.push({name:i,amount:r[i].toLocaleString("en-US")});return{sum:a.toLocaleString("en-US"),result:o}}function u(e){e.forEach(function(e,n){var o=e.details;if(!o||o.length<1)return!1;o.forEach(function(e,n){var o=e.amount?parseFloat(e.amount):0;if(a+=o,void 0!==e.name){var i=t.ContentIDMap[e.name];r[i]=r[i]?r[i]+o:o}})})}},sumMargins:function(){var t=this.project.margins,e={sumGuaranteeAmount:0,sumGuaranteeCost:0,sumPaymentCost:0};return t.length<1?e:(t.forEach(function(t,n){e.sumGuaranteeAmount+=t.guarantee_amount?parseFloat(t.guarantee_amount):0,e.sumGuaranteeCost+=t.guarantee_cost?parseFloat(t.guarantee_cost):0,e.sumPaymentCost+=t.payment_amount?parseFloat(t.payment_amount):0}),e)},sumPaymentConditions:function(){var t=this.project.paymentConditions,e=0;return t.length<1?e:(t.forEach(function(t,n){e+=t.expected?parseFloat(t.expected):0}),e)}},methods:{addFirstItem:function(t){var e=this.project[t],n=e.length,a=void 0;a=n>0?e[n-1].id+1:1,"masterContract"===t||"subContract"===t?this.project[t].push({id:a,details:new Array}):this.project[t].push({id:a})},deleteFirstItem:function(t,e,n){this.project[t].splice(n,1)},addSecondItem:function(t,e){var n=this.project[t][e].details||[],a=n.length,r=void 0;r=a>0?n[a-1].id+1:1,this.project[t][e].details.push({id:r})},deleteSecondItem:function(t,e,n,a){this.project[t][e].details.splice(n,1)},fileUpload:function(t){var e=t.target.files,n=new FormData,a=!0,r=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var s=i.value;this.project.contracts.push({id:s.size,name:s.name}),n.append("image",s)}}catch(t){r=!0,o=t}finally{try{!a&&u.return&&u.return()}finally{if(r)throw o}}}}})});