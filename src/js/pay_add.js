"use strict";$(document).ready(function(){new Vue({el:"#payAdd",data:{payForm:{apply_user:"",date:"",price:"",application:"",project_id:"",project_content:""},checkedMen:[],menList:[],throttle:{id_timer:null,name_timer:null,payee_timer:null},selectData:{id:""},currentSupplier:{},invoiceType:[],payeeType:[],payeeDetail:[]},mounted:function(){this.payForm.date=_helper.timeFormat(new Date,"YYYY-MM-DD"),this.payForm.apply_user=$("#applyUser").val(),$("#payAdd").removeClass("invisible");var e=$("#invoiceType").text().trim();this.invoiceType=""===e?[]:JSON.parse(e);var t=$("#payeeType").text().trim();this.payeeType=""===t?[]:JSON.parse(t)},methods:{querySearchProjectId:function(e,t){var a=this;clearTimeout(this.throttle.id_timer),this.throttle.id_timer=setTimeout(function(){var r={id:e,type:"pay_add"};_http.ProjectManager.searchProject(r).then(function(e){"200"===e.data.code?t(e.data.data):a.$notify({title:"错误",message:e.data.msg||"未知错误",type:"error"})}).catch(function(e){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectProjectId:function(e){this.payForm.project_id=e.id,this.payForm.project_number=e.number,this.payForm.project_content=e.name},querySearchProjectContent:function(e,t){var a=this;clearTimeout(this.throttle.name_timer),this.throttle.name_timer=setTimeout(function(){var r={name:e};_http.ProjectManager.searchProject(r).then(function(e){"200"===e.data.code?t(e.data.data):a.$notify({title:"错误",message:e.data.msg||"未知错误",type:"error"})}).catch(function(e){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectProjectContent:function(e){this.payForm.project_id=e.id,this.payForm.project_number=e.number,this.payForm.project_content=e.name},querySearchPayee:function(e,t){var a=this;clearTimeout(this.throttle.payee_timer),this.throttle.payee_timer=setTimeout(function(){var r={name:e};_http.ProjectManager.searchProject(r).then(function(e){"200"===e.data.code?t(e.data.data):a.$notify({title:"错误",message:e.data.msg||"未知错误",type:"error"})}).catch(function(e){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectPayee:function(e){this.currentSupplier=e},submit:function(){var e=this;_http.PaymentManager.createPayAdd(this.payForm).then(function(t){"200"===t.data.code?(e.$notify({title:"成功",message:"提交成功",type:"success"}),e.selectData.id=t.data.data.id,_http.UserManager.searchAuthUsers({role:"pay_pass"}).then(function(a){"200"===a.data.code?(e.menList=a.data.data,$(".ui.dimmer").addClass("active")):e.$notify({title:"错误",message:t.data.msg,type:"error"})})):e.$notify({title:"错误",message:t.data.msg,type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})},handleCheckManChange:function(e){console.log(this.checkedMen)},confirmRecheck:function(){var e=this;this.selectData.users=this.checkedMen,_http.PaymentManager.selectPay(this.selectData).then(function(t){"200"===t.data.code?(e.$notify({title:"成功",message:"已选择了审批人",type:"success"}),$(".ui.dimmer").removeClass("active")):e.$notify({title:"错误",message:t.data.msg,type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})}}})});