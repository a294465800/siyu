"use strict";$(document).ready(function(){new Vue({el:"#checkCollect",data:{collectForm:_schemas.checkCollect,banks:[{id:1,name:"中国银行",account:0xdd7cc016fa7b28},{id:2,name:"平安银行",account:0xe1b80ca67d20f8},{id:3,name:"广发银行",account:0xe15b47ecd74258},{id:4,name:"中央银行",account:0xdd7cc016fa7b28}],throttle:{unit_timer:null,bank_timer:null}},mounted:function(){$(".tabular.menu .item").tab(),this.project_id=$("#projectId").val(),$("#checkCollect").removeClass("invisible")},methods:{querySearchCompany:function(t,e){var a=this;this.throttle.unit_timer&&clearTimeout(this.throttle.unit_timer),this.throttle.unit_timer=setTimeout(function(){var c={payee:t,project_id:""};_http.ProjectManager.searchProjectUnit(c).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectCompanyA:function(t){this.collectForm.margins.payee=t},handleSelectCompanyB:function(t){this.collectForm.masterContract.payee=t},handleSelectCompanyC:function(t){this.collectForm.subContract.payee=t},querySearchBank:function(t,e){var a=this;this.throttle.bank_timer&&clearTimeout(this.throttle.bank_timer),this.throttle.bank_timer=setTimeout(function(){var c={name:t};_http.BankManager.searchBank(c).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectBankA:function(t){this.collectForm.margins.bank_id=t.id,this.collectForm.margins.bank=t.name,this.collectForm.margins.account=t.account},handleSelectBankB:function(t){this.collectForm.masterContract.bank_id=t.id,this.collectForm.masterContract.bank=t.name,this.collectForm.masterContract.account=t.account},handleSelectBankC:function(t){this.collectForm.subContract.bank_id=t.id,this.collectForm.subContract.bank=t.name,this.collectForm.subContract.account=t.account},checkSubmit:function(t){var e=this.collectForm[t];console.log(e);for(var a in e)if(void 0===e[a]||""===e[a])return console.log(a),this.$notify.error({title:"错误",message:"请确保已填写所有内容！"}),!1;switch(t){case"margins":this.marginsSubmit(t);break;case"masterContract":this.masterContractSubmit(t);break;case"subContract":this.subContractSubmit(t);break;case"subCompany":this.subCompanySubmit(t);break;default:return!1}},clearData:function(t){for(var e in this.collectForm[t])this.collectForm[t][e]=""},marginsSubmit:function(t){var e=this,a=this,c=this.collectForm[t];c.project_id=this.project_id,c.type=1,_http.CheckManager.createProjectCollect(c).then(function(c){"200"===c.data.code?(e.clearData(t),a.$notify.success({title:"成功",message:"提交成功！"})):e.$notify({title:"错误",message:c.data.msg,type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})},masterContractSubmit:function(t){var e=this,a=this,c=this.collectForm[t];c.project_id=this.project_id,c.type=2,_http.CheckManager.createProjectCollect(c).then(function(c){"200"===c.data.code?(e.clearData(t),a.$notify.success({title:"成功",message:"提交成功！"})):e.$notify({title:"错误",message:c.data.msg,type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})},subContractSubmit:function(t){var e=this,a=this,c=this.collectForm[t];c.project_id=this.project_id,c.type=3,_http.CheckManager.createProjectCollect(c).then(function(c){"200"===c.data.code?(e.clearData(t),a.$notify.success({title:"成功",message:"提交成功！"})):e.$notify({title:"错误",message:c.data.msg,type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})},subCompanySubmit:function(t){var e=this,a=this,c=this.collectForm[t];c.project_id=this.project_id,c.type=4,_http.CheckManager.createProjectCollect(c).then(function(c){"200"===c.data.code?(e.clearData(t),a.$notify.success({title:"成功",message:"提交成功！"})):e.$notify({title:"错误",message:c.data.msg,type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})}}})});