"use strict";$(document).ready(function(){new Vue({el:"#projectCheckDialog",data:{currentType:"masterContract",centerDialogVisible:!1,map:{marginLeft:"预计回收",marginRight:"实际回收",finish:"预计请款",company:"发包公司",subContract:"分包合同",masterContract:"主合同"},unitMap:{marginLeft:"pay_unit",marginRight:"payee",finish:"pay_unit",company:"",subContract:"payee",masterContract:"payee"},marginLeft:{pay_date:"",price:"",pay_unit:"",remark:""},marginRight:{pay_date:"",price:"",payee:"",bank:"",account:""},finish:{pay_date:"",price:"",pay_unit:"",remark:""},company:{pay_date:"",remark:""},subContract:{payee:"",pay_date:"",price:"",bank:"",account:""},masterContract:{payee:"",pay_date:"",price:"",bank:"",account:""},throttle:{unit_timer:null,bank_timer:null},currentId:"",project_id:""},mounted:function(){this.project_id=$("#projectId")||"";var t=this;$(".edit-btn").on("click",function(){var e=this,a=$(this),i=a.data("type"),n=a.data("id");t.currentId=n,t.currentType=i;var r="marginLeft"===i||"finish"===i?"getTip":"getCollect";_http.CheckManager[r]({id:n}).then(function(a){"200"===a.data.code?(t[i]=a.data.data,t.centerDialogVisible=!0):e.$notify({title:"错误",message:a.data.msg||"未知错误",type:"error"})}).catch(function(t){e.$notify({title:"错误",message:"服务器出错",type:"error"})})})},methods:{querySearchCompany:function(t,e){var a=this;this.throttle.unit_timer&&clearTimeout(this.throttle.unit_timer),this.throttle.unit_timer=setTimeout(function(){var i={payee:t,project_id:a.project_id||""};_http.ProjectManager.searchProjectUnit(i).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectCompany:function(t){var e=this.currentType;this[e][this.unitMap[e]]=t},querySearchBank:function(t,e){var a=this;this.throttle.bank_timer&&clearTimeout(this.throttle.bank_timer),this.throttle.bank_timer=setTimeout(function(){var i={name:t};_http.BankManager.searchBank(i).then(function(t){"200"===t.data.code?e(t.data.data):a.$notify({title:"错误",message:t.data.msg||"未知错误",type:"error"})}).catch(function(t){a.$notify({title:"错误",message:"服务器出错",type:"error"})})},500)},handleSelectBank:function(t){var e=this.currentType;this[e].bank=t.name,this[e].account=t.account},submit:function(){var t=this,e="marginLeft"===this.currentType||"finish"===this.currentType?"editTip":"editCollect",a=Object.assign({},{id:this.currentId},this[this.currentType]);_http.CheckManager[e](a).then(function(e){"200"===e.data.code?(t.$notify.success({title:"成功",message:"已修改"}),t.centerDialogVisible=!1):t.$notify({title:"错误",message:e.data.msg||"未知错误",type:"error"})}).catch(function(e){t.$notify({title:"错误",message:"服务器出错",type:"error"})})}}})});